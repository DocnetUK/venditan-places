!function(a){var b={init:function(c){var d=this,e=a.extend({autocomplete:{},callback:function(){},excludeTerms:[],fields:["place_id","name","address_component","types","geometry"],logLookup:!0,logURL:"/json_account_address_lookup",postLog:function(){},logPostVariable:"postcode",restrictions:{},types:[]},c);e.autocomplete=new google.maps.places.Autocomplete(d[0],{types:e.types}),e.autocomplete.setFields(e.fields),e.autocomplete.setComponentRestrictions(e.restrictions),e.autocomplete.addListener("place_changed",function(){b.process(d)}),d.data("settings",e),d.on("focus",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var b={lat:a.coords.latitude,lng:a.coords.longitude},c=new google.maps.Circle({center:b,radius:a.coords.accuracy});d.data("settings").autocomplete.setBounds(c.getBounds())})})},process:function(c){var d=c.data("settings"),e=d.autocomplete.getPlace();if("undefined"!=typeof e){var f=e.address_components[e.address_components.length-1];e.types.includes("postal_code")&&(f=e.address_components[0],e.address_components.push(e.address_components.shift())),f.long_name.length<6?a.when(a.ajax("//api.postcodes.io/postcodes",{type:"get",data:{lon:e.geometry.location.lng(),lat:e.geometry.location.lat(),limit:1}})).done(function(a){200===a.status&&(e.address_components[e.address_components.length-1]={long_name:a.result[0].postcode,short_name:a.result[0].postcode},"function"==typeof d.callback&&b.do_callback(c,e))}):"function"==typeof d.callback&&b.do_callback(c,e)}},do_callback:function(a,c){return a.data("settings").place=c,b.cleanse(a),a.data("settings").logLookup&&b.do_log(a,c),a.data("settings").callback.call(this)},do_log:function(b,c){var d={};d[b.data("settings").logPostVariable]=c.address_components[c.address_components.length-1].short_name,a.ajax({type:"POST",url:b.data("settings").logURL,data:d,async:!0}).done(b.data("settings").postLog)},cleanse:function(a){var c=a.data("settings"),d=c.place.address_components,e=c.excludeTerms;for(var f in d)(e.includes(d[f].long_name)||e.includes(d[f].short_name)||""===d[f].long_name)&&(d.splice(f,1),b.cleanse(a));return d},get:function(a){return this.data("settings")[a]},set:function(a,b){var c=this.data("settings");c[a]=b}};a.fn.places=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.places"):b.init.apply(this,arguments)}}(jQuery);
//# sourceMappingURL=jquery.venditan-places.min.js.map